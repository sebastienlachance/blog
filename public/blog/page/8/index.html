
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Sebastien Lachance</title>
  <meta name="author" content="Sebastien Lachance">

  
  <meta name="description" content="I have been using NDepend on various project I am working on and there is so much to say that I can&rsquo;t wait to do a full review because I will &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sebastienlachance.com/blog/page/8">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/sebastienlachance/feed" rel="alternate" title="Sebastien Lachance" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-10165653-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Sebastien Lachance</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/sebastienlachance/feed" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sebastienlachance.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/resume">Resume</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/ndepend-small-review/">NDepend - Small review</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-08-10T09:07:00-04:00" pubdate data-updated="true">Aug 10<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been using <a href="http://www.ndepend.com/">NDepend</a> on various project I am working on and there is so much to say that I can&rsquo;t wait to do a full review because I will make you wait too long. I got a free license and wanted you to know what the tool can do and what were my impression.</p>


<p>First of all NDepend is a tool that analyse your code. It&rsquo;s huge! Definitely not a tool you can learn in an hour or two. Simply give the tool a solution or project file and start analyzing. You are first presented with a a complete map of your application. By default it shows all your code sorted by the number of lines but you can quickly switch by different kinds of metrics (LOC, Cyclomatic Complexity, IL instructions, Efferent coupling, etc.).</p>


<p><a title="ndependcomplete" href="http://www.flickr.com/photos/63483657@N00/3724199730/"><img src="http://static.flickr.com/3439/3724199730_0127dffd0b.jpg" border="0" alt="ndependcomplete" width="680" height="516" /></a></p>


<p>The best part is that you can write query against your code. This feature is called CQL (custom query language). Need to know which method have more than 200 lines of code? No problem. Really. It looks like SQL and is easy to write (I haven&rsquo;t written any yet, but I&rsquo;m sure it will prove useful later).</p>


<p>Take a look at this :</p>


<div id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E6:42d5c7d5-dae6-4381-bb88-43e02dd5509e" class="wlWriterSmartContent" style="display:inline;float:none;margin:0;padding:0;">
<pre style="background-color:White;white-space:-moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; white-space: pre-wrap; word-wrap: break-word;overflow: auto;"><span style="color: #008000;">//</span><span style="color: #008000;"> &lt;Name&gt;Methods with too many local variables (NbVariables)&lt;/Name&gt;</span><span style="color: #008000;">
</span><span style="color: #000000;">WARN IF Count </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> IN SELECT TOP </span><span style="color: #800080;">10</span><span style="color: #000000;"> METHODS WHERE NbVariables </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #800080;">15</span><span style="color: #000000;"> ORDER BY NbVariables DESC</span></pre>
<!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>


<p>Out of the box, NDepend provide around 200 CQL queries. It has queries to find unused or dead code, find which method are not test covered, naming convention not respected, types with too many methods, ect. Each rules has a short description on what it does and even provide links to more complete documentation if needed. It also has intellisence as if this wasn&rsquo;t enough.</p>


<p>A cool feature is the dependency matrix. It&rsquo;s easy to see where is your dependencies.</p>


<p><a title="ndependmatrix" href="http://www.flickr.com/photos/63483657@N00/3723410225/"><img src="http://static.flickr.com/3420/3723410225_31dfb32f18.jpg" border="0" alt="ndependmatrix" /></a></p>


<p>The tools itself is beautiful, it make us want to play more with it (it does not use WPF, but it appears to).</p>


<p>A lot of features that I haven&rsquo;t used yet are :</p>


<ul>
<li>Compare assemblies</li>
<li>Code Coverage</li>
<li>Writing complex&nbsp; custom rules</li>
</ul>


<p>I recently came across this post entry by <a href="http://codebetter.com/blogs/patricksmacchia/">Patrick Smacchia</a> (creator of NDepend) that used the tools to spot bugs in an existing code base (<a href="http://codebetter.com/blogs/patricksmacchia/archive/2009/06/21/agile-behavior-nurture-knowledge-database.aspx">http://codebetter.com/blogs/patricksmacchia/archive/2009/06/21/agile-behavior-nurture-knowledge-database.aspx</a>). I don&rsquo;t know why but this has really struck me and kept it in my favourites. I could write custom query to spot bad practices and potential bugs.</p>


<p>But there is a downside. On a project I worked last year. Every query that has been executed had a warning on it, almost every single one. That&rsquo;s sad. I almost cried. But I&rsquo;m fine now. NDepend will help me.</p>


<p>There is so much to say, that it&rsquo;s almost impossible to cover it all in one single post. I&rsquo;ll continue to use it and post any relevant information and features that I really enjoyed in the next couple of weeks.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vivim-30-days-conclusion/">Conclusion of my Vim 30 days trial</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-07-15T09:04:00-04:00" pubdate data-updated="true">Jul 15<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m way too late to post the conclusion of the trial, but for all of you who wanted to know here are the results.</p>


<p>Will I continue to use vi/Vim in my everyday life? Probably. But not for a little while. The experience was fun but I did not find that my productivity increased a lot. I can&rsquo;t really say for sure. The problem I had was that I did not have a proper typing technique. So I found myself distracted because I was hitting the wrong key and caused side effects. So, I came to the conclusion that I needed to learn how to type properly.</p>


<p>I have already started to follow the lessons provided by <a href="http://www.typeonline.co.uk/">typeonline.co.uk</a>. And while typing with the proper skill in Visual Studio, I found myself missing <a href="http://www.viemu.com/">viEmu</a> real bad. I did not wanted to remove my hand from the keyboard to move around. Having seen what vi/vim was capable of, it&rsquo;s a huge way back.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vivim-30-days-day-6/">vi/Vim 30 days - Day 6</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-29T00:08:00-04:00" pubdate data-updated="true">May 29<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>That was disastrous. No really. I had a lot of modifications to be made fast and it just seemed that viEmu was always in the way. I&rsquo;m not blaming viEmu here, it&rsquo;s just because I was not completely comfortable with it and I should had it deactivated for the rush. On another side, I learned how to do search without using Ctrl-F. Disturbing at first, a must now. 24 days left.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vivim-30-days-day-5/">vi/Vim 30 days - Day 5</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-28T00:08:00-04:00" pubdate data-updated="true">May 28<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m starting to really like this. I&rsquo;m much more confident and often I don&rsquo;t need to think twice before using a command. Today I have used many times the &ldquo;yank &amp; put&rdquo; keys along with v,V (selection)&nbsp; and o,O (new line before of after the current line). I am not required to think. So far, so good.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vim-30-days-day-4/">Vim 30 days - Day 4</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-25T09:09:00-04:00" pubdate data-updated="true">May 25<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I had real opportunity to use gVim so I decided to install <a href="http://www.viemu.com/">ViEmu for Visual Studio</a> and give it a try. A had a lot of code to write on a recent application I&#8217;m working on so why not.</p>


<p>I&#8217;m starting to get a hand on basic navigation and on inserting/appending removing/deleting characters. It&#8217;s too soon to know I it had improved my productivity yet, but I&#8217;m still learning so let&#8217;s see in a couple of days how it goes.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vivim-30-days-day-3/">Vi/Vim 30 days - Day 3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-22T09:10:00-04:00" pubdate data-updated="true">May 22<span>nd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Not been typing much today, but I wanted at least to clear something. How do I cut/paste <strong>inside</strong> gVim.</p>


<p>First you need to enter the selection mode by hitting &#8220;v&#8221;. Then move the cursor to select text using h, j, k, l, w, e, etc. When the text is selected, hit &#8220;d&#8221;. This will cut the text. Now hit &#8220;p&#8221; to put the line back.</p>


<p>On another note, I talked about vi/vim to some of my colleagues and friends and everyone is just laughing at me. Everyone seems to agree that there is no points in learning this and should stick with &#8220;what everyone do&#8221;. I do hope to show them what it&#8217;s really about.&nbsp;&nbsp;</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vivim-30-days-day-2/">Vi/Vim 30 days - Day 2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-21T09:10:00-04:00" pubdate data-updated="true">May 21<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Day 2 of the trial, I have gone through half the tutorial (up to Lesson 3.3) and I begin to see where the power of this vi/vim residing. The most annoying thing so far is the color scheme/font that is not remembered, but I&#8217;m pretty sure it will have to do with learning vi (maybe a hidden command or something :P, or maybe not and will have to modify a config file somewhere).</p>


<p>Here is a recap of what I learned today</p>


<p>First, I have been using the &#8220;w&#8221; and &#8220;e&#8221; key to navigate through text in &#8220;Normal mode&#8221; (Normal Mode is where you are when you are not typing, hitting ESC get you there).</p>


<p>Next, the &#8220;x&#8221; key. Again, in normal mode, you hit the x key to delete the remaining of the words. If you are at the start of the word, it removes it completely and if you are at the second characters, it remove all remaining characters after the cursor.</p>


<p>This is it. I learned a lot through the tutorial but haven&#8217;t used it much so it does not count. Tomorrow I will try a few new commands to keep learning it until I&#8217;m a master of vi/vim!!</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vivim-30-days-day-1/">Vi/Vim 30 days - Day 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-20T09:11:00-04:00" pubdate data-updated="true">May 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve decided to give a serious try to the like of vi/vim. I have heard a lot of gossip around thoses editors and since it&#8217;s supposed to increase productivity (and I want to increase my productivity), I decided that I should at least try it for 30 days. I&#8217;ve started this morning and found out that it&#8217;s a hell of a learning curve.</p>


<p>I&#8217;ve downloaded <a href="http://www.vim.org/download.php">gVim</a> this morning and used it for all the things that involved typing (except Visual Studio, waiting to be more familiar with it). The first interaction was a little bit strange. I admit I had to use the mouse to start editing since I had no idea at all why I need to type &#8220;i&#8221; to start typing.</p>


<p>Later that day, I stumbled across the <a href="http://www.viemu.com/a-why-vi-vim.html">&#8220;why page&#8221; of viEmu</a>, the author does a good job of clearing things. Mainly the use of the &#8220;normal&#8221; and &#8220;edit&#8221; mode. To start writing text, you need hit &#8220;i&#8221; and as soon as you are finish you hit &#8220;Esc&#8221; to get you back in navigation mode. The &#8220;normal&#8221; mode is where you need to stay at all time when you are not typing.</p>


<p>Where I have a lot of difficulty on this first day, is the use of the h,j,k,l keys to navigate through the text file. I&#8217;m still trying to apply the mnemonics of the first lesson of the tutorial (h is the leftmost key so you move left, j looks like the down arrow, l is the right most key so it goes right, and then k is up). I have not understood yet how it works since it&#8217;s seem to go everywhere, but where I want it to go.</p>


<p>And the last things I learned is the :sav command, which is basically the save as function.</p>


<p>I have not picked all the terms correctly since it&#8217;s only the first day and had not the time to read through all the tutorials. But I&#8217;ll keep you up to date with my new way of typing.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/the-install-location-for-prerequisites-has-not-been-set-to-component-vendors-web-site-and-the-file-dotnetfx35setupexe-in-item-microsoftnetframework35sp1-cannot-be-located-on-disk/">&#8216;The install location for prerequisites has not been set&#8217; error</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-11T08:00:00-04:00" pubdate data-updated="true">May 11<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I think I needed to make this post since I was struck by this problem 2 times in the last year. And I didn&rsquo;t learn from the first time, so here is the error message I got along with 50+ others that looked the same when building a setup from Visual Studio 2008.</p>


<p><em>The install location for prerequisites has not been set to &#8216;component vendor&#8217;s web site&#8217; and the file &#8216;dotNetFx35setup.exe&#8217; in item &#8216;Microsoft.Net.Framework.3.5.SP1&#8217; cannot be located on disk.</em></p>


<p>At fist, I was thinking that I haven&rsquo;t downloaded the right version of the framework so, I have gone mad trying to find one that was entitled &ldquo;redistributable&rdquo;. Can&rsquo;t find. Humm maybe something has to do with Visual Studio not looking for the right folder (Program Files vs Program Files (x86)). No.</p>


<p>After a lot of questions and no answer, I found a lost notes in Evernote stating that I should read the VS 2008 SP 1 readme file&hellip;</p>


<p>Section 2.3.1.1 : Enable Samesite for the .NET Framework 3.5 SP1 bootstrapper package</p>


<p>Here is the section content for those who don&rsquo;t want to search for their readme file.</p>


<blockquote>
<p>Update the Package Data</p>
<ol>
<li>Open the [Program Files]\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\DotNetFx35SP1 folder or %ProgramFiles(x86)%\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\DotNetFx35SP1 on x64 operating systems </li>
<li>Edit the Product.xml file in Notepad. </li>
<li>Paste the following into the &lt; PackageFiles &gt; element:        <br />&lt; PackageFile Name=&#8221;TOOLS\clwireg.exe&#8221; /&gt;         <br />&lt; PackageFile Name=&#8221;TOOLS\clwireg_x64.exe&#8221; /&gt;         <br />&lt; PackageFile Name=&#8221;TOOLS\clwireg_ia64.exe&#8221; /&gt; </li>
<li>Find the element for &lt; PackageFile Name=&#8221;dotNetFX30\XPSEPSC-x86-en-US.exe&#8221; and change the PublicKey value to: 3082010A0282010100A2DB0A8DCFC2C1499BCDAA3A34AD23596BDB6CBE2122B794C8EAAEBFC<br /> 6D526C232118BBCDA5D2CFB36561E152BAE8F0DDD14A36E284C7F163F41AC8D40B146880DD9<br />8194AD9706D05744765CEAF1FC0EE27F74A333CB74E5EFE361A17E03B745FFD53E12D5B0CA5E0DD<br />07BF2B7130DFC606A2885758CB7ADBC85E817B490BEF516B662<br />5DED11DF3AEE215B8BAF8073C345E3958977609BE 7AD77C1<br />378D33142F13DB62C9AE1AA94F9867ADD420393071E08D6746E2C61CF40D5074412FE8052<br /> 46A216B49B092C4B239C742A56D5C184AAB8FD78E833E780A47D8A4B28423C3E2F27B66B14A74B<br /> D26414B9C6114604E30C882F3D00B707CEE554D77D2085576810203010001 (REMOVE LINE BREAKS!)</li>
<li>Find the element for &lt; PackageFile Name=&#8221;dotNetFX30\XPSEPSC-amd64-en-US.exe&#8221; and change the PublicKey value to the same as in step 4 above </li>
<li>Save the product.xml file </li>
</ol> Download and Extract the Core Installation Files     <ol>
<li>Navigate to the following URL: http://go.microsoft.com/fwlink?LinkID=118080 </li>
<li>Download the dotNetFx35.exe file to your local disk. </li>
<li>Open a Command Prompt window and change to the directory to which you downloaded dotNetFx35.exe. </li>
<li>At the command prompt, type:        <br />dotNetFx35.exe /x:.         <br />This will extract the Framework files to a folder named &ldquo;WCU&rdquo; in the current directory. </li>
<li>Copy the contents of the WCU\dotNetFramework folder and paste them in the %Program Files%\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\DotNetFx35SP1 folder (%ProgramFiles(x86)%\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\DotNetFx35SP1 on x64 operating systems). Note: Do not copy the WCU\dotNetFramework folder itself. There should be 5 folders under the WCU folder, and each of these should now appear in the DotNetFx35SP1 folder. The folder structure should resemble the following:        <br />o DotNetFx35SP1 (folder)                   
<ul>
<li>dotNetFX20 (folder </li>
<li>dotNetFX30 (folder) </li>
<li>dotNetFX35 (folder) </li>
<li>dotNetMSP (folder) </li>
<li>TOOLS folder) </li>
<li>en (or some other localized folder) </li>
<li>dotNetFx35setup.exe (file)            <br />You may now delete the files and folders you downloaded and extracted in steps 2 and 4. </li>
</ul>
</li>
</ol></blockquote>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/subtle-deadly-bug/">Subtle deadly bug</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-28T09:12:00-04:00" pubdate data-updated="true">Apr 28<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I almost never give my opinion about code I see, but I felt this one was interesting and educative. It all started while working on a legacy project (an ASP.NET web application), I found out that most connections were not closed. So I fixed them all and making sure every connection was closed once the I finished with it, should an error occurred or not.</p>


<div id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E6:8118b2d6-5135-47d0-b247-ef271923e7a1" class="wlWriterSmartContent" style="display:inline;float:none;margin:0;padding:0;">
<pre style="background-color:#FFFFFF;white-space:pre-wrap;overflow:auto;"><span style="color:#0000FF;">try</span><span style="color:#000000;">
{
    </span><span style="color:#0000FF;">using</span><span style="color:#000000;"> (IDataReader reader </span><span style="color:#000000;">=</span><span style="color:#000000;"> SqlHelper.ExecuteReader(Sql.MainConnection, </span><span style="color:#800000;">"</span><span style="color:#800000;">sp_name</span><span style="color:#800000;">"</span><span style="color:#000000;">, paramter1, parameter2))
    {
        </span><span style="color:#0000FF;">while</span><span style="color:#000000;"> (dr.Read())
        {
            </span><span style="color:#008000;">//</span><span style="color:#008000;">do something</span><span style="color:#008000;">
</span><span style="color:#000000;">        }
    }
}
</span><span style="color:#0000FF;">finally</span><span style="color:#000000;">
{
    Sql.MainConnection.Close();
}
</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></p>
</div>


<p>&nbsp;</p>


<p>Pretty basic stuff. Today I deployed the application to a server for some testing. After two or&nbsp; three users getting in, Boumm! SQL Server is dead. I check the activity monitor and found out that a hundred connections were still open. The reason is : I have wrongly assumed that a static class in the project was providing me with a connection that was shared between all data access class.</p>


<p>I was sure I was closing all the connection, but I ended up closing nothing.&nbsp; Let&rsquo;s take a look at the MainConnection property of the Sql class :</p>


<div id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E6:01969617-5143-4414-a4b7-7872c03b234f" class="wlWriterSmartContent" style="display:inline;float:none;margin:0;padding:0;">
<pre style="background-color:#FFFFFF;overflow:auto;"><span style="color:#0000FF;">public</span><span style="color:#000000;"> </span><span style="color:#0000FF;">static</span><span style="color:#000000;"> SqlConnection GetMainConnection
{
    </span><span style="color:#0000FF;">get</span><span style="color:#000000;"> { </span><span style="color:#0000FF;">return</span><span style="color:#000000;"> </span><span style="color:#0000FF;">new</span><span style="color:#000000;"> SqlConnection(</span><span style="color:#800000;">"</span><span style="color:#800000;">connectionstring</span><span style="color:#800000;">"</span><span style="color:#000000;">); }
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></p>
</div>


<p>Each time I was accessing the database, and it was accessed a lot (20 times per request), I ended up with a lot of open connections. Enough to make SQL Server unavailable for some time. You could argue that it was my mistake and I shouldn&rsquo;t be assuming things like this. But in my opinion, it&rsquo;s a case of bad naming. The choice of name for the property that return me a connection was inconstant. If I access a property, I assumed that if I call it five times in a row, I would have five times the same result. The best choice would have been to create a method that return a new connection and name it accordingly.</p>


<div id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E6:bfa7123c-52b7-4563-821f-c65f85cb9f1a" class="wlWriterSmartContent" style="display:inline;float:none;margin:0;padding:0;">
<pre style="background-color:#FFFFFF;overflow:auto;"><span style="color:#0000FF;">public</span><span style="color:#000000;"> </span><span style="color:#0000FF;">void</span><span style="color:#000000;"> SqlConnection GetNewSqlConnection()
{
    </span><span style="color:#0000FF;">return</span><span style="color:#000000;"> </span><span style="color:#0000FF;">new</span><span style="color:#000000;"> SqlConnection(</span><span style="color:#800000;">"</span><span style="color:#800000;">connectionString</span><span style="color:#800000;">"</span><span style="color:#000000;">);
}</span></pre>
<p><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></p>
</div>


<p>It would have reduced the ambiguity and would have been a lot more easy to read. Good naming is very important and can greatly enhance productivity on a project. Good code should be easy to read and you should not ask yourself if a calling a method would cause side-effects or not doing what it said it should.</p>


<p>&nbsp;</p>


<div id="scid:d7bf807d-7bb0-458a-811f-90c51817d5c2:d29c8c0a-0596-4844-956f-a942b68268e0" class="wlWriterSmartContent" style="display:inline;float:none;margin:0;padding:0;">
<p><span class="TagSite">Technorati:</span> <a class="tag" rel="tag" href="http://technorati.com/tag/Learning">Learning</a>, <a class="tag" rel="tag" href="http://technorati.com/tag/.NET">.NET</a>, <a class="tag" rel="tag" href="http://technorati.com/tag/SQL+Server">SQL Server</a>, <a class="tag" rel="tag" href="http://technorati.com/tag/DataAccess">DataAccess</a><br /> <!-- StartInsertedTags: Learning, .NET, SQL Server, DataAccess :EndInsertedTags --></p>
</div>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/9/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/7/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <img src="/images/me.png" />
  <p>Sebastien Lachance, programmer since 2003.</p>
  <p>I am an entrepreneur and consultant. I have launched the <a href="http://www.guidedescommercesdebeauce.com">Guide des Commerces</a> in 2011, a project with great potential and had a lot of fun making it. 
  </p>
  <p>
    I&#8217;m a web developer specialized in Rails and ASP.NET MVC. I have a background in business applications but I really enjoy making any kind of software. 
  </p>
  <p>
    I do believe in the power of twitter, but I dont use it as much as I would.
    But feel free to follow me anyway :).
  </p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/an-real-world-application-with-backbone-my-story/">A real world application with Backbone and Rails - My story &#8230; so far</a>
      </li>
    
      <li class="post">
        <a href="/blog/rails-assets-pipeline-and-missing-assets/">Rails Assets Pipeline and missing assets</a>
      </li>
    
      <li class="post">
        <a href="/blog/method-decorators-in-ruby/">Method decorators in Ruby</a>
      </li>
    
      <li class="post">
        <a href="/blog/learning-rails-assert-valid-keys/">Learning Rails : assert_valid_keys</a>
      </li>
    
      <li class="post">
        <a href="/blog/large-scale-javascript-application-architecture-by-addy-osmani/">Large-scale Javascript Application Architecture by Addy Osmani</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sebastienlachance">@sebastienlachance</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sebastienlachance',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("slachance", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/slachance" class="twitter-follow-button" data-show-count="true">Follow @slachance</a>
  
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Sebastien Lachance -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sebastienlachance';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
